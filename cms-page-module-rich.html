{% assign item_nr = forloop.index %}

<div
    data-pat-collapsible="trigger: #{{ include.title | slugify }}-title-segment; store: local; scroll-selector: self; scroll-offset: 120px"
    id="{{ include.title | slugify }}"
    class="cms-page-module type-rich pat-collapsible {{ include.state }}">
    {% include prozin/cms-page-module-title.html %}
    <div 
        class="panel-content">
        {% comment %}
            <fieldset 
                class="horizontal form-panel metadata">
                <fieldset
                    class="pat-checklist">
                    <legend>{% include patterns/i18n id="label_header" %}</legend>
                    <label>
                       {% include patterns/i18n id="label_show_header" %}
                        <input 
                            type="checkbox" 
                            checked
                            name="toc">
                    </label>
                </fieldset>
            </fieldset>
        {% endcomment %}
        <article
            class="body-text pat-rich">
            {% if include.content %}
                {% capture this_content %}{{ include.content | markdownify }}{% endcapture %}
            {% else %}
                {% capture this_content %}{{ page.content | markdownify }}{% endcapture %}
            {% endif %}
            
            {% include
                patterns/rich-editor.html
                placeholder="Your content goes hereâ€¦"
                autofocus=false
                toolbar="editor-toolbar"
                image-panel="#pat-modal.image-picker"
                image-menu="/dialogues/cms/image-menu#document-content"
                link-panel="#pat-modal.panel-hyperlink"
                link-menu="/dialogues/cms/hyperlink-menu#document-content"
                content=this_content %}
        </article>
    </div>
</div>